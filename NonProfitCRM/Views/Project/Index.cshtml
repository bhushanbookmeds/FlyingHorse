@model IEnumerable<NonProfitCRM.Models.Project>
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_SiteLayout.cshtml";
}

@*<a asp-action="Details" asp-route-id="@item.Id">Details</a> |*@
<div class="row">
    <div class="col-sm-12">
        <div class="page-title-box">
            <div class="float-right">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="javascript:void(0);">Project</a></li>
                    <li class="breadcrumb-item active">View All</li>
                </ol>
            </div>
            <h4 class="page-title">Project</h4>
        </div><!--end page-title-box-->
    </div><!--end col-->
</div>
<!-- end page title end breadcrumb -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body profile-card">
                <div class="row">
                    <div class="media align-items-center">
                        @*<img src="../assets/images/users/user-4.jpg" alt="user" class="rounded-circle thumb-lg">*@
                        <div class="media-body ml-3 align-self-center">
                            <h5 class="mt-0 mb-1" id="contactName"></h5>
                            <p class="mb-1 text-muted">Lead Manager</p>
                        </div>
                    </div>
                </div><!--end card-body-->
            </div><!--end card-->
        </div><!-- end col-->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <a asp-action="Create" class="btn btn-primary px-4 btn-rounded float-right mt-0 mb-3">+ Add New</a>

                        <h4 class="header-title mt-0 mb-3">Project Details</h4>
                        <div class="table-responsive dash-social">
                            <table id="datatable" class="table">
                                <thead class="thead-light">
                                    <tr>
                                        <th>Name</th>

                                    
                                        <th>Lead</th>
                                        <th>Close Date</th>
                                        <th>Allocated Fund</th>
                                        <th>Status</th>
                                        <
                                        <th>Action</th>
                                    </tr><!--end tr-->
                                </thead>

                                <tbody>
                                    @foreach (var item in Model)
                                    {
                                        <tr>
                                            <td><img src="../assets/images/users/user-10.jpg" alt="" class="thumb-sm rounded-circle mr-2"><a asp-action="Details" asp-route-Id=@item.Id>@Html.DisplayFor(modelItem => item.Name)</a></td>

                                            <td>@Html.DisplayFor(modelItem => item.StartDate)</td>
                                            <td>@Html.DisplayFor(modelItem => item.Contact.Name)</td>
                                            <td>@Html.DisplayFor(modelItem => item.EndDate)</td>
                                            <td>@Html.DisplayFor(modelItem => item.AllocatedFund)</td>
                                            <td>@Html.DisplayFor(modelItem => item.Status)</td>
                                           


                                            <td>
                                                <a asp-controller="Project" asp-action="Edit" asp-route-Id=@item.Id class="mr-2"><i class="fas fa-edit text-info font-16" onclick="return confirm('Are you sure to edit the record')"></i></a>
                                                <a asp-controller="Project" asp-action="Delete" asp-route-Id="@item.Id"><i class="fas fa-trash-alt text-danger font-16" onclick="return confirm('Are you sure to delete the record')"></i></a>
                                            </td>
                                        </tr><!--end tr-->
                                    }
                                </tbody>
                            </table>
                        </div>
                    </div><!--end card-body-->
                </div><!--end card-->
            </div> <!--end col-->
        </div><!--end row-->
    </div>
</div>
@section Scripts
              {
    <script type="text/javascript">
                  $(document).ready(function ()
                   {
                    $('#Contact_Name').autocomplete({
                       delay: 500,
                       minLength: 1,
                        source: '@Url.Action("Search","Project")',
                        select: function (event, ui)
                          {
                              $("#Contact_Name").val(ui.item.label);
                             this.value = ui.item.label;
                            $('#Contact_Name').show();

                            $("#ContactId").val(ui.item.id)


                               debugger
                               selectFunction(ui.item.id);
                          return false;

                        }
                    });
                }); function selectFunction(id) {
                            $.ajax({
                                type: "GET",
                                url: '@Url.Action("GetContactDetails","Project")/' + id,
                                data: {},
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (data) {


                                    if (data) {

                                        $('#contactName').html(data.name);

                                    }
                                    else {
                                        alert("Somthing went wrong");
                                    }



                                    return data;
                                    //$("Contact_Name").hide(function () { $("div.success").fadeIn(); });
                                },
                                //error: function (XMLHttpRequest, textStatus, errorThrown) {
                                //    alert("Status: " + textStatus); alert("Error: " + errorThrown);
                                //}


                            });
                        };

    </script>

}
